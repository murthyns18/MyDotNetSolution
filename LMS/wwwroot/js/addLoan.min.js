function loadUsers(){$.ajax({url:apiURL+"User/UserList",type:"GET",data:{userID:-1},success:function(n){$("#ddlUser").empty().append(`<option value="">-- Select User --</option>`);n.forEach(n=>{$("#ddlUser").append(`<option value="${n.userID}">${n.userName}</option>`)})}})}function loadPublishers(){$.ajax({url:apiURL+"Publisher/PublisherList",type:"GET",data:{publisherID:-1},success:function(n){$("#ddlPublisher").empty().append(`<option value="">-- Select Publisher --</option>`);n.forEach(n=>{$("#ddlPublisher").append(`<option value="${n.publisherID}">${n.publisherName}</option>`)})},error:function(){App.alert("Failed to load publishers.")}})}function addBook(){const n=$("#ddlBook").val(),t=$("#ddlBook option:selected").text(),i=$("#ddlPublisher option:selected").text();if(!n){App.alert("Please select a book");return}if(selectedBooks.length>=4){App.alert("Maximum 4 books allowed");return}if(selectedBooks.some(t=>t.bookId==n)){App.alert("Book already added");return}selectedBooks.push({bookId:parseInt(n),bookName:t,publisherName:i});renderSelectedBooks();$("#ddlPublisher").val("");$("#ddlBook").empty().append(`<option value="">-- Select Book --</option>`)}function removeBook(n){selectedBooks=selectedBooks.filter(t=>t.bookId!==n);renderSelectedBooks()}function renderSelectedBooks(){const n=$("#tblSelectedBooks tbody");if(n.empty(),selectedBooks.length===0){n.append(`
            <tr>
                <td colspan="4" class="text-center text-muted">
                    No books added
                </td>
            </tr>
        `);return}selectedBooks.forEach(t=>{n.append(`
            <tr>
                <td>
                    <button class="btn btn-sm btn-danger"
                            onclick="removeBook(${t.bookId})">
                        <i class="bi bi-trash"></i>
                    </button>
                </td>
                <td>${t.bookName}</td>
                <td>${t.publisherName}</td>
                <td class="text-center">1</td>
            </tr>
        `)})}function submitLoan(){const n=$("#ddlUser").val();if(!n)return App.alert("Please select user"),!1;if(selectedBooks.length===0)return App.alert("Add at least one book"),!1;$("#UserId").val(n);const t=$("#loanDetailsContainer");return t.empty(),selectedBooks.forEach((n,i)=>{t.append(`
            <input type="hidden" name="LoanDetails[${i}].BookId" value="${n.bookId}" />
            <input type="hidden" name="LoanDetails[${i}].Qty" value="1" />
        `)}),!0}$.ajaxSetup({beforeSend:function(n){typeof TOKEN!="undefined"&&TOKEN&&n.setRequestHeader("Authorization","Bearer "+TOKEN)}});let selectedBooks=[];$("#ddlUser").on("change",function(){const n=$(this).val();n&&$.ajax({url:apiURL+"User/UserList",type:"GET",data:{userID:n},success:function(n){const t=n[0];$("#txtName").val(t.userName);$("#txtEmail").val(t.email);$("#txtAddress").val(t.address);$("#txtMobile").val(t.mobileNumber)}})});$("#ddlPublisher").on("change",function(){const n=$(this).val();($("#ddlBook").empty().append(`<option value="">-- Select Book --</option>`),n)&&$.ajax({url:apiURL+"Book/GetBooksByPublisher",type:"GET",data:{publisherId:n},success:function(n){if(!n||n.length===0){App.alert("No books available for this publisher");return}n.forEach(n=>{$("#ddlBook").append(`<option value="${n.bookID}">${n.title}</option>`)})},error:function(){App.alert("Failed to load books")}})});$(function(){loadUsers();loadPublishers();renderSelectedBooks()});
//# sourceMappingURL=addLoan.min.js.map