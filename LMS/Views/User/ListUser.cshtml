@model IList<User>

<div class="container mt-4">

    <div class="d-flex align-items-center mb-3 justify-content-between">
        <h4>User List</h4>
        <div>
            <a href="@Url.Content("~/User/AddUser")" class="btn btn-primary">
                Add User
            </a>
        </div>
    </div>

    <div class="table-responsive">

        <div class="container-fluid">
            <table id="userGrid"></table>
            <div id="userPager"></div>
        </div>


        @* <table class="table table-bordered table-striped table-hover">
            <thead class="table-primary text-left header">
                <tr>
                    <th>Action</th>
                    <th>Sl.No</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Mobile</th>
                    <th>Role</th>
                    <th>Address</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @if(Model != null && Model.Any())                           
                {
                    @foreach (var user in Model)
                    {
                        <tr>
                            <td class="text-center">
                                <a href="@Url.Action("EditUser", "User", new { id = user.UserID })" class="btn btn-sm btn-info text-light me-1">Edit</a>

                                <form asp-action="DeleteUser" method="post" class="d-inline">
                                    <input type="hidden" name="id" value="@user.UserID" />
                                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                </form>
                            </td>
                            <td>@user.UserID</td>
                            <td>@user.UserName</td>
                            <td>@user.Email</td>
                            <td>@user.MobileNumber</td>
                            <td>@user.RoleName</td>
                            <td>@user.Address</td>
                            <td class="text-center">
                                <span class="badge @(user.Status ? "bg-success" : "bg-danger")">
                                    @(user.Status ? "Active" : "Inactive")
                                </span>
                            </td>
                            
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="9" class="text-center text-danger">No users available</td>
                    </tr>
                }
            </tbody>
        </table> *@

    </div>

</div>
<script>
    // ACTION BUTTONS
        function actionFormatter(cellValue, options, row) {
        return `
            <div class="jqgrid-action">
                <a href="/User/EditUser/${row.userID}" class="btn btn-sm btn-info text-white">Edit</a>

                <form method="post" action="/User/DeleteUser" style="display:inline;"">
                    <input type="hidden" name="id" value="${row.userID}" />
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
            </div>
        `;
    }

    // STATUS BADGE
    function statusFormatter(value) {
        return value ? "<span class='badge bg-success'>Active</span>" : "<span class='badge bg-danger'>Inactive</span>";
    }

    $(function () {
        $("#userGrid").jqGrid({
            url: '/User/GetUsersForGrid',
            datatype: "json",
            mtype: "GET",

            colModel: [
                   {
                    label: "Action",
                    name: "action",
                    width: 140,
                    fixed: true,
                    align: "center",
                    formatter: actionFormatter,
                    cellattr: function () {
                        return "style='white-space:nowrap;'";
                    }
                }
                ,
                { label: "ID", name: "userID", key: true, width: 50, align: "center", hidden:true },
                { label: "Name", name: "userName", width: 150 },
                { label: "Email", name: "email", width: 220 },
                { label: "Mobile", name: "mobileNumber", width: 120 },
                { label: "Role", name: "roleName", width: 120 },
                { label: "Address", name: "address", width: 200 },
                {
                    label: "Status",
                    name: "status",
                    width: 90,
                    align: "center",
                    formatter: statusFormatter
                }
            ],

            pager: "#userPager",
            rowNum: 10,
            rowList: [10, 20, 50, 60],
            autowidth: true,
            shrinkToFit: true,
            height: "auto",
            viewrecords: true,
            caption: "User List",

            jsonReader: {
                root: "rows",
                page: "page",
                total: "total",
                records: "records",
                repeatitems: false,
                id: "userID"
            }
        });
    });
</script>
    